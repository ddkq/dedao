<!doctype html>
<html lang="en">
	<tc_include file="Public:head" />
	<title>全城征集2018位缺牙市民_{$site_name}</title>
	<link rel="stylesheet" href="__TMPL__Zt/qmzj/base.css">
	<script src="__TMPL__Public/jquery-2.1.1.min.js"></script>
</head>
<body>

	<img src="__TMPL__Zt/qmzj/imgs/1.jpg" />
	<img src="__TMPL__Zt/qmzj/imgs/2.jpg" />
	<php> 
		$tables = sp_get_tables(24); 
		$content = json_decode($tables['content'],true); 
		$submit = array_pop($content);
		//var_dump($content);exit;
	</php>
	<div class="index-situation">
		
		<form id="form1" method="post" enctype="multipart/form-data">
			<input type="hidden" name="table_id" value="{$tables['id']}" />
			<input type="hidden" name="page" class="page" />
			<input type="hidden" name="code" value="{$code = mt_rand(0,1000000)}">
			<volist name="content" id="vo" key="k">
				<eq name="vo[type]" value="1">
					<div class="situation-input-text">
						<input required="required" type="text" data-type="{$vo.type}" name="data[name]"  placeholder="{$vo.name}">
						<span class="input-clear"></span>
					</div>
				</eq>
				<eq name="vo[type]" value="2">
					<div class="situation-input-text">
						<input required="required" type="text" data-type="{$vo.type}" name="data[phone]"  placeholder="{$vo.name}">
						<span class="input-clear"></span>
					</div>
				</eq>
				<eq name="vo[type]" value="12">
					<h4 class="must" data-type="{$vo.type}">{$vo.name}</h4>
					<php> 
						$options = sp_get_options($vo['radio']);
						$options_content = json_decode($options['content'],true);
						//var_dump($options_content);exit; 
					</php>
					<div class="checkbox-control checkbox-box multiple-box">
						<volist name="options_content" key="k2" id="vo1">
							<label class="checkbox-item">
								<input type="checkbox" value="{$vo1.name}" class="radio-style cheakbox1">
								<span>{$vo1.name}</span>
							</label>
						</volist>
						<input type="hidden" data-type="{$vo.type}" name="data[symptom]" value="">
					</div>
				</eq>
				<eq name="vo[type]" value="11">
					<h4 class="must" data-type="{$vo.type}">{$vo.name}</h4>
					<php> 
						$options = sp_get_options($vo['radio']);
						$options_content = json_decode($options['content'],true);
						//var_dump($options_content);exit; 
					</php>
					<div class="checkbox-control checkbox-box">
						<volist name="options_content" id="vo1">
							<label class="checkbox-item cheakbox-single">
								<input type="radio" value="{$vo1.name}" data-type="{$vo.type}" name="data[age]" class="radio-style">
								<span>{$vo1.name}</span>
							</label>
						</volist>
					</div>
				</eq>
			</volist>

			<div class="situation-btn">
				<a href="javascript:;" class="submit-btn">{$submit.name}</a>
			</div>	
		</form>
		
	</div>
	<img src="__TMPL__Zt/qmzj/imgs/3.jpg" />
	<img src="__TMPL__Zt/qmzj/imgs/4.gif" />
	<img src="__TMPL__Zt/qmzj/imgs/5.jpg" />
	<div class="rich-text">
		<div class="inner">
			<p style="text-align: center;">成都青羊德道口腔医院</p>
			<p style="text-align: center;">（成青） 医广【2018】第06-05-510105045号</p>
			<p><br></p>
		</div>
	</div>
</body>
<script>
	
	$(function(){
		$('.page').val(window.location.href);
	});
	
	// $('body').on('click', '.checkbox-single label', function() {
	// 	$('.checkbox-single label input').prop('checked', false);
	// 	$(this).children('input').prop('checked', true);
	// })
	
	var options = "";
	
	
	//多选
	$('.cheakbox1').on('click', function(){
		if($(this).is(':checked')) {
			options += $(this).val() + ',';
		}
		else {
			options = options.split($(this).val() + ',').join("");
		}
		$(this).parent('label').nextAll('input').attr('value',options);
	})

	$('body').on('input', '.situation-input-text input', function() {
		var inputValue = $(this).val();
		inputValue == '' ? '' : $(this).next().css('display', 'block')
	})
	$('body').on('click', '.input-clear', function() {
		$(this).prev().val('');
		$(this).css('display', 'none');
	})
	
	
	$('body').on('click', '.submit-btn', function() {	
		var name = $("input[data-type=1]").val();
		var re1 = /^[\u4E00-\u9FA5]{1,6}$/; 
		if(name == null){
			alert("姓名不能为空"); 
			return false; 
		}else if(name != null){
			if (!re1.test(name)){ 
				alert("姓名格式不正确"); 
				return false; 
			}	
		}
		

		var phone = $("input[data-type=2]").val();
		var re2 = /^((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+(\d{8})$/;
		if(phone == null){
			alert("电话不能为空"); 
			return false; 
		}else if(phone != null){
			if (!re2.test(phone)){ 
				alert("电话格式不正确"); 
				return false; 
			}
		}
		
		var options = $("input[data-type=12]").val();
		if(options == null){
			alert("请选择相关数据"); 
			return false;
		}
		var radios = $("input[data-type=11]").val();
		if(radios == null){
			alert("请选择相关数据"); 
			return false;
		}
		
		var data = $('#form1').serializeArray();
		$.post('/tables/tables/add_post',data,function(result){
			//console.log(result);
			alert(result.info);
		});
	});
	
	
</script>
</html>